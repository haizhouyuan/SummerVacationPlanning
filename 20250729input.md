好的，我会分析 SummerVacationPlanning 库的 production-ready-v1.0 分支中的代码，并结合之前“暑期积分奖励计划”项目的背景，重新梳理需求和优先级，制定一份明确的 todolist。稍后会向您反馈结果。


基于 `SummerVacationPlanning` 仓库 `production-ready-v1.0` 分支的代码和文档，可以看到该项目已经实现了完整的暑期活动规划平台：后台采用 Node.js+Express+MongoDB，提供任务管理、每日任务打卡、积分奖励、家长审批和兑换等接口；前端则是 React+Tailwind 的游戏化界面。核心功能包括学生端的智能任务规划和证据上传，家长端的监控仪表板、任务审批和积分兑换管理，以及积分和游戏时间兑换规则。项目文档中的《EarnPoints》设计了详细的积分获取与兑换机制，如写日记、阅读、数学课程、编程/DIY、音乐练习、体育运动和家务劳动等活动的标准积分及兑换比例。

### 现有主要功能梳理

* **任务库与任务管理**：后台提供任务路由，支持创建、查看、更新和删除任务，对标题、描述、类别、难度、预计时间等进行校验。任务控制器在创建时会根据难度和预计时间自动计算基础积分，并提供根据用户偏好生成推荐任务和行为洞察的服务。
* **每日任务（打卡）**：学生可以将某个任务计划到某天的日程中，每日任务支持状态切换（planned/in\_progress/completed/skipped）、计划时间和备注，并在完成时上传文字、图片或视频证据。完成任务时系统会按基础积分+证据奖励计算最终得分，并结合勋章倍率后累加到用户账户。
* **家长审批与周统计**：后台为家长提供获取待审批任务和审批接口，家长可以通过 `/pending-approval` 和 `/approve` 路由批量查看并审核孩子的每日任务。同时提供按周统计接口，计算完成率、各状态任务数及积分收入。
* **积分与奖励兑换**：

  * **任务积分**：任务控制器提供 `calculateTaskPoints` 和 `getActivityPoints`，根据难度、时间和活动类型（阅读、学习、运动等）确定基础积分并提供各类活动的积分规则。
  * **游戏时间兑换**：奖励控制器根据兑换比率将积分换算成游戏时间，区分普通游戏和教育游戏，提供每日基础游戏时间、教育类游戏前20分钟免费等功能。积分消耗后记录兑换并更新用户剩余积分。
  * **兑换奖励/商品**：通过 redemption 接口，孩子可以提交“奖励兑换”请求，包含奖励标题、描述和所需积分；家长审批后扣除或退回积分。

### 需要重点优化与补充的部分

虽然现有功能基本完整，但结合早期“暑期积分奖励计划”中提出的设计（积分获取、兑换比例、奖励设计等），下一步应突出以下两个核心目标：

1. **任务规划与记录、家长确认**
   需要让任务的选择→计划→执行→打卡→家长确认形成闭环，简化学生操作、提高家长体验。
2. **积分奖励机制的平衡**
   积分规则要兼顾公平性和激励性，支持灵活调整，以防止某些任务过度积累积分或奖励不合理。

### 按优先级整理的需求与 To‑Do 列表

| 优先级   | 需求/任务              | 说明                                                                                                                                                                     |
| ----- | ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **高** | **任务规划与打卡流程完善**    | 在前端实现任务库浏览、筛选和选择，允许用户为选定任务设置日期/计划时间/提醒，并生成每日任务记录（planned 状态）；打卡页面需支持快速更新状态（开始、完成、跳过）并上传多种证据文件。                                                                         |
| **高** | **家长审批工作流**        | 后端已有 `/pending-approval` 与 `/approve` 接口，需要前端实现家长仪表板：显示待审批任务的列表（带证据预览和子任务信息），允许家长批量审批或拒绝并添加评语与奖励加成。完成审批后需更新任务状态并通知孩子（可用前端通知或邮件）。                                       |
| **高** | **调整并统一积分计算规则**    | 代码中存在 `calculateTaskPoints` 和 `getActivityPoints`，但与《EarnPoints》文档的积分建议相比仍有差异。应将积分规则配置化，例如在数据库中存储每种活动/难度/时间段的基准分值和上限，使家长或管理员可以调整；统一任务积分、每日任务奖励、勋章倍率、bonus 分等逻辑，避免重复实现。 |
| **高** | **每日/每周积分上限与平衡机制** | 根据文档建议，运动等任务每天最多奖励 3 分，类似规则未在代码中体现；需要在积分计算时加入类别和时间段的上限判断，避免孩子通过单一任务刷分。                                                                                                 |
| **中** | **改进奖励兑换和游戏时间规则**  | 当前兑换规则支持普通游戏和教育游戏、基础30分钟和教育前20分钟免费。根据《EarnPoints》文档，兑换比例应可配置（例如 1 分=5 分钟普通游戏、1 分=10 分钟教育游戏），并允许未用完积分累计和积分扣除项。需要在后端抽象兑换率配置，并提供前端界面供家长查看和调整。                             |
| **中** | **积分/奖励报告与排行榜**    | 为家长端提供可视化报告：包括孩子在某段时间内的任务完成度、积分获取和消耗、游戏时间使用情况，以及在多子女家庭中的排行榜。                                                                                                           |
| **中** | **推荐系统优化**         | 推荐服务已经根据用户历史完成情况生成建议任务。为了增加趣味性，可在前端展示推荐理由（scoreBreakdown）并允许孩子反馈（如标记喜欢/不喜欢），为后续算法微调提供依据。                                                                               |
| **低** | **活动和奖励的个性化配置**    | 允许家长定义新的任务模板和奖励项目（如特定商品或体验），并指定积分成本；支持积分扣除和返还逻辑。                                                                                                                       |
| **低** | **通知与提醒系统**        | 实现邮件或应用内通知，提醒孩子按计划完成任务、提醒家长有待审批任务或兑换请求。                                                                                                                                |

### 建议的开发顺序和交付物

1. **梳理现有后端接口与文档**：确认所有 API 的请求/响应格式，对比需求是否缺失或不一致。先完成任务计划与审批功能的后端完善（若需要调整数据库结构）以及积分规则的配置化存储。
2. **前端任务和审批流程开发**：按高优先级需求，实现任务选择与计划 UI、打卡界面和家长审批仪表板，确保上传证据、多状态切换和审批功能稳定。
3. **积分计算与兑换规则调整**：重构后端积分逻辑，将积分配置抽离到数据库或配置文件，根据《EarnPoints》文档提供的建议设置默认值，并支持限额与倍率等平衡机制。
4. **补充游戏时间/兑换管理界面**：在家长端实现配置兑换比率、查看兑换历史和剩余积分/时间的功能；在学生端显示每日基础时间、已兑换时间和可用剩余时间。
5. **报表与推荐优化**：在后端增加查询统计功能，前端提供周/月统计视图和排行榜；对推荐服务加入反馈记录，以便后续算法优化。
6. **长期改进**：支持自定义奖励、积分扣罚逻辑、通知系统等。

这些任务完成后，可以形成一个闭环的暑期积分激励系统：孩子通过任务规划与打卡累计积分，家长通过审核和调整积分规则确保公平和激励效果，同时系统提供数据报告和个性化推荐，持续改进体验。
