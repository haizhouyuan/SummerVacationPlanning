<!-- Generated by SpecStory -->

# 修改 Playwright MCP 配置为 Edge (2025-08-23 03:55Z)

_**User**_

修改 Playwright MCP 配置 – 将 Playwright MCP（模型上下文协议服务器）的默认浏览器从 Chrome 改为 Edge，并启用隔离模式以避免冲突：

打开 Claude 的配置文件（Windows 系统通常位于 %APPDATA%\Claude\claude_desktop_config.json）。

找到其中关于 "playwright" MCP 服务器的配置段落，并在其 "args" 列表中添加以下参数：

"args": [
  "@playwright/mcp@latest",
  "--browser", "msedge",           // 指定使用 Edge 浏览器:contentReference[oaicite:1]{index=1}
  "--isolated"                     // 启用隔离模式，防止配置文件锁冲突:contentReference[oaicite:2]{index=2}
]


保存配置文件并重启 Claude Code/VS Code 扩展，使新配置生效（重启后，Playwright MCP 将使用 Edge 浏览器）。

---

_**Assistant**_



---

我现在将直接在本机用 PowerShell 修改 `claude_desktop_config.json` 的 Playwright MCP 配置：设置 `--browser msedge` 并添加 `--isolated`，并输出更新后的 args 以核对。随后再提示你重启扩展。

---

Cancelled

---



---

_**User**_

停着不动了

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Considering file indentation and formatting**

I'm thinking about whether the system's reminder to preserve indentation applies here. It seems pretty generic, and since we'll modify a JSON file, preserving the exact format is tricky, but it should be fine because it's a config. We need to avoid duplicating '--browser' too. I’ll plan to create a function that checks for the file, backs it up, processes the JSON, updates necessary values, and finally writes it back. Let's ensure each step is handled robustly!
**Executing command updates**

I'm planning to print the file path along with the arguments and possibly the JSON itself. It’s important to let the user know that they need to restart the extension afterward. I might also consider running a command to show the file type, but that feels optional. Before making any tool calls, I'll include a status update to communicate what's happening. I’ll say something like, “我来重新以非交互方式执行一次修改，并打印结果,” then I'll proceed with running the command. Let's go for it!</details></think>

---

我来重新以非交互方式执行一次修改，并打印结果用于核对。

---

Cancelled

---

_**User**_

The terminal process "C:\Program Files\PowerShell\7\pwsh.exe" terminated with exit code: 1.

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Checking configuration file existence**

I think the first step is to check if the configuration file exists by printing the path to help with debugging. The user's rules pertain to creating issues, but since this task focuses on local configuration, we can skip that aspect. I'll include a status update before running any tool calls and aim for parallel execution while gathering information. I'll run a command to check the path and verify if the config file is present, considering different possible file names.
**Verifying configuration file path**

For Windows, the configuration path to check is AppData\Roaming\Claude\claude_desktop_config.json. I'll verify its existence with a smaller command since there seem to be issues with the terminal tool. Although the developer instructions suggest continuing with tools, it could be helpful to provide manual steps if necessary. I’ll run a command that checks if the path exists and prints a snippet of its content in sanitized JSON format, ensuring everything is set up for PowerShell 7.
**Planning configuration updates**

I need to provide a status update before proceeding. If the configuration file exists, we could simplify editing it using `jq`, but PowerShell can handle JSON modifications too. I wonder if truncation is a problem due to size. If the terminal fails again, I can suggest manual editing instructions. The user’s rule is to summarize the CLI output after running, so I’ll start with a minimal check. Then, if it exists, I’ll adjust the configuration for `mcpServers` while preserving existing commands.
**Running existence check**

I want to make sure to add `'@playwright/mcp@latest'` as the first element, along with including `'--browser'`, `'msedge'`, and `'--isolated'`. Before proceeding, I need to run a check command first. Even though the instructions suggest parallelizing calls when possible, it looks like we only need to make one call for this step. So, let’s go ahead and execute the existence check to confirm whether the configuration file is present.</details></think>

---

我先检查本机 `claude_desktop_config.json` 是否存在及其当前位置，然后再做修改。

---

Cancelled

---



---

_**User**_

又停下来了

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Evaluating tool usage and steps**

I need to include status updates before making any tool calls, and I remember we’d previously added micro-updates. While we can run commands in parallel, this time I'll go step by step. I can check for file existence, read content, or propose a command for a single line. However, I see the tool indicates a new shell starts with each invocation, so I'll have to clarify how that would work. I'll also ensure to keep my response concise and ask for user permission to run any commands on their system.
**Addressing user issue**

The user mentioned "又停下来了," which means it’s stuck. I can suggest a fallback: offering two simple commands, like backing up and opening the file in Notepad, or backing up and using jq/Powershell to modify it. I want to try again with a shorter command since the earlier ones might have been truncated due to line wrapping. I’ll focus on extremely brief steps like checking if the path exists, displaying file content, and running a minimal script to parse and update the JSON.
**Simplifying command execution**

To avoid overly long single lines, I can create a temporary .ps1 file in the %TEMP% directory for execution. Smaller commands could be echoed to create the script, although escaping quotes can be tricky in PowerShell. Alternatively, I could use `Set-Content` with a here-string approach. Another option is to utilize `jq`, but it may not be installed on Windows. The user's request is to change the default browser to Edge and enable isolation. I'll straightforwardly replace the `args` property while preserving simplicity and ensure it aligns with their requirements.
**Optimizing PowerShell command**

I can simplify the PowerShell one-liner to streamline the commands. The new command allows me to back up the configuration, convert JSON content, and check for necessary properties before updating the `args` to set the browser to Edge and enable isolation. While this might still be a bit lengthy, we can manage outputs by using `| Out-Null` to reduce unnecessary print statements. Additionally, I'll include status updates and provide a summary once finished, or offer the option for a manual edit with Notepad for a more robust approach.
**Implementing commands with fallback**

Following developer instructions, I should continue with the task despite the environment issues. If the tool fails again, I can provide commands the user can run directly. I need to keep the "status update spec" as a micro-update before any tool calls. I plan to run a shorter command with minimal outputs, so I’ll focus on a single execution to avoid interruptions. 

I'll build a small script and check if the JSON file exists, and if not, I'll create the necessary properties and save the changes. If this attempt fails, I'll then provide manual steps and a simple command to open `Notepad`.</details></think>

---

我先用更短的一条 PowerShell 命令直接备份并覆盖 `playwright` 的 args（设置 `--browser msedge` 和 `--isolated`），执行后会打印当前参数用于核对。

---

```bash
$ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpServers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwright){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwright.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Set-Content -Path $p -Encoding UTF8; Write-Output '当前 args：'; ($j.mcpServers.playwright.args -join ' | ')
```

```
} else { Write-Output 'Exists: False$ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
D:\SummerVacationPlanning [master]> $ErrorActionPreference='Stop'; $p=Join-Path $env:APPDATA 'Claude\claude_
desktop_config.json'; if(!(Test-Path $p)){Write-Output "不存在: $p"; exit 1}; Copy-Item $p ($p+'.bak-'+(Get-
Date -Format yyyyMMddHHmmss)) -Force; $j=Get-Content $p -Raw | ConvertFrom-Json -Depth 100; if(-not $j.mcpSe
rvers){$j | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{})}; if(-not $j.mcpServers.playwri
ght){$j.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{})}; $j.mcpServers.playwr
ight.args=@('@playwright/mcp@latest','--browser','msedge','--isolated'); $j | ConvertTo-Json -Depth 100 | Se
t-Content -Path $p -Encoding UTF8; Write-Output '当前 args：'; ($j.mcpServers.playwright.args -join ' | ')  
x3b $j.mcpServers.playwright.args=@('@playwright/mcp@latest','--browser','msedge','--isolated')\x3b $j | Con
vertTo-Json -Depth 100 | Set-Content -Path $p -Encoding UTF8\x3b Write-Output '当前 args：'\x3b ($j.mcpServe
rs.playwright.args -join ' | ')不存在: C:\Users\admin\AppData\Roaming\Claude\claude_desktop_config.json
```

---

<think><details><summary>Thought Process</summary>**Ensuring config structure**

I need to focus on creating a correct structure. It seems we can create a config file for mcpServers, but is that okay? For Claude Desktop, the config file might be optional. If it’s not there, we can simply create one named "claude_desktop_config.json." We must ensure this doesn't interfere with any existing config. Since it doesn’t exist, I’ll move forward with a new one that contains the required content. It's also important to provide executable commands for the user!
**Following repository rules**

I need to check the repo-specific rules for using GH CLI, but since the user hasn’t asked to "开个 issue," we don’t actually need to generate GH commands right now. I must provide a status update before any tool calls. Previously, I've included short updates, but since we likely won’t be using more tool calls, we might just propose creating the config file. I’ll craft a PowerShell command that ensures the folder exists and writes a minimal JSON with mcpServers.playwright.args as required, while also validating it afterward.
**Creating configuration file**

It seems the previous commands were interrupted, possibly due to issues with the "run_terminal_cmd" tool and long commands. I’ll still give it a shot while keeping things concise. I'll set the directory to `$dir = Join-Path $env:APPDATA 'Claude'; New-Item -ItemType Directory -Force $dir;`, and then point to the config file with `$path = Join-Path $dir 'claude_desktop_config.json'`. If the file exists, I could merge it; otherwise, I'll write a minimal JSON with the standard configuration. Since the user wants to "打开 Claude 的配置文件...找到...添加 args," I’ll ensure the necessary content is added.
**Creating the config file carefully**

I need to be careful not to disturb any existing sections when I create the config file. Since the file isn't there, I can go ahead and create it without worrying about merging with old content. If the file had existed, I would have worked on merging it instead. It's good to ensure that the new content is added properly while keeping everything else intact. Let's proceed with the creation!
**Implementing robust script**

I'm setting up a solid script. First, I’ll define the directory and ensure it exists. If the config file is already there, I will load the JSON and check for the "mcpServers" and "playwright" entries, setting the command to "npx" if it's missing. I’ll set the args precisely, save it, and then print the path and final args.

To keep things concise, I’ll write the PowerShell code in a single line with necessary separators while respecting the manual input constraints. Also, I’ll ensure to summarize the output and provide status updates throughout the process!</details></think>

---

我将直接创建或合并配置文件：若不存在则新建并写入 `playwright` 的 `args`（使用 Edge 与隔离模式）；若已存在则备份后更新。执行后会打印配置路径与最终参数，便于核对。

---

Cancelled

---



---

_**User**_

又停下来了

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Recommending options for setup**

I want to keep things simple by setting args to '@playwright/mcp@latest', '--browser', 'msedge', and '--isolated.' This change might override any extra arguments the user had intended to use, which could be problematic. So, it makes sense to show both options: a straightforward option and one that merges scripts but is more complex. 

We’ll also suggest restarting the Claude Code or VS Code extension and provide a sample JSON for the user to paste. Lastly, I’ll include a fallback command for installing the Playwright Edge driver if needed.</details></think>

---

- 我不再在后台代你执行命令了。接下来给你一条可复制的 PowerShell 脚本，你本机运行即可完成配置。

### 一键覆盖更新（推荐，最稳）
把下方整段粘贴到 PowerShell（pwsh 或 Windows PowerShell）执行：
```powershell
$ErrorActionPreference='Stop'
$dir = Join-Path $env:APPDATA 'Claude'
$path = Join-Path $dir 'claude_desktop_config.json'
New-Item -ItemType Directory -Force -Path $dir | Out-Null
if (Test-Path $path) { Copy-Item $path "$path.bak-$(Get-Date -Format yyyyMMddHHmmss)" -Force }
$json = if (Test-Path $path) { Get-Content $path -Raw | ConvertFrom-Json -Depth 100 } else { [pscustomobject]@{} }
if (-not $json.mcpServers) { $json | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{}) }
if (-not $json.mcpServers.playwright) { $json.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{}) }
if (-not $json.mcpServers.playwright.command) { $json.mcpServers.playwright | Add-Member -NotePropertyName command -NotePropertyValue 'npx' }
$json.mcpServers.playwright.args = @('@playwright/mcp@latest','--browser','msedge','--isolated')
$json | ConvertTo-Json -Depth 100 | Set-Content -Path $path -Encoding UTF8
'OK: ' + $path
'args: ' + ($json.mcpServers.playwright.args -join ' ')
```

- 运行成功后，最后两行会输出配置路径与当前 args，确认应包含：`@playwright/mcp@latest --browser msedge --isolated`
- 然后重启 Claude Code/VS Code 扩展，使设置生效。

### 保留其他参数的合并更新（可选）
若你原本 `args` 里还有其它参数并希望保留，用下面脚本（会清理旧的 `--browser ...` 和 `--isolated`，再写入 Edge 和隔离）：
```powershell
$ErrorActionPreference='Stop'
$dir = Join-Path $env:APPDATA 'Claude'
$path = Join-Path $dir 'claude_desktop_config.json'
New-Item -ItemType Directory -Force -Path $dir | Out-Null
if (Test-Path $path) { Copy-Item $path "$path.bak-$(Get-Date -Format yyyyMMddHHmmss)" -Force }
$json = if (Test-Path $path) { Get-Content $path -Raw | ConvertFrom-Json -Depth 100 } else { [pscustomobject]@{} }
if (-not $json.mcpServers) { $json | Add-Member -NotePropertyName mcpServers -NotePropertyValue (@{}) }
if (-not $json.mcpServers.playwright) { $json.mcpServers | Add-Member -NotePropertyName playwright -NotePropertyValue (@{}) }
if (-not $json.mcpServers.playwright.command) { $json.mcpServers.playwright | Add-Member -NotePropertyName command -NotePropertyValue 'npx' }
if (-not $json.mcpServers.playwright.args) { $json.mcpServers.playwright | Add-Member -NotePropertyName args -NotePropertyValue (@()) }
$args = @($json.mcpServers.playwright.args | ForEach-Object { $_ })
$clean = @()
for ($i=0; $i -lt $args.Count; $i++) {
  if ($args[$i] -eq '--browser') { $i++; continue }
  elseif ($args[$i] -eq '--isolated') { continue }
  else { $clean += $args[$i] }
}
if (-not ($clean -contains '@playwright/mcp@latest')) { $clean = @('@playwright/mcp@latest') + $clean }
$clean += @('--browser','msedge','--isolated')
$json.mcpServers.playwright.args = $clean
$json | ConvertTo-Json -Depth 100 | Set-Content -Path $path -Encoding UTF8
'OK: ' + $path
'args: ' + ($json.mcpServers.playwright.args -join ' ')
```

### 如果仍失败
- 请把命令行的完整错误输出贴过来，我帮你判断（常见情况是没有该文件目录或权限问题）。
- 你也可以手动编辑 `%APPDATA%\Claude\claude_desktop_config.json`，确保包含：
```json
{
  "mcpServers": {
    "playwright": {
      "command": "npx",
      "args": [
        "@playwright/mcp@latest",
        "--browser", "msedge",
        "--isolated"
      ]
    }
  }
}
```
- 保存后重启扩展。

状态更新：我不再尝试在你的终端后台执行，改为提供两种可复制的命令方案（覆盖或合并）以避免“卡住”。运行后请告诉我终端输出结果。

---

